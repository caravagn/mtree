<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>mtree • mtree</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="mtree">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mtree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mtree.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>mtree</h1>
            
      
      
      <div class="hidden name"><code>mtree.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># To render in colour this vignette</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">old.hooks &lt;-<span class="st"> </span>fansi<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fansi/man/set_knit_hooks.html">set_knit_hooks</a></span>(knitr<span class="op">::</span>knit_hooks)</a></code></pre></div>
<style type="text/css" scoped>
PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};
</style>
<p>The <code>mtree</code> is a package to implement basic functions to create, manipulate and visualize mutation trees. A mutation tree is a tree built from binary sequencing data that reports the presence or absence of a set of somatic variants (mutations, copy number etc.) in multiple tumour biopsies.</p>
<p>The trees created with <code>mtree</code> are used inside <a href="https://github.com/caravagn/revolver">REVOLVER</a>, a package that implements one algorithm to determine <a href="https://www.nature.com/articles/s41592-018-0108-x">repeated cancer evolution from multi-region sequencing data of human cancers</a>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mtree)</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #BBBBBB;background-color: #0000BB;"> [ Mtree - Mutation Trees in cancer ] 
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">Author : </span><span> Giulio Caravagna &lt;gcaravagn@gmail.com&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; GitHub : </span><span> caravagn/mtree </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span>
</span></code></pre>
<p>To build a mutation tree you need some basic datal; an example dataset is attached to the package and can be used to create a <code>ctree</code> S3 object.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">'mtree_input'</span>)</a></code></pre></div>
<div id="required-data" class="section level3">
<h3 class="hasAnchor">
<a href="#required-data" class="anchor"></a>Required data</h3>
<p><strong>Binary data</strong></p>
<p>Binary data that reports the presence (<code>1</code>) or absence (<code>0</code>) of any somatic event that you want annotate in your data. To run <code>mtree</code> you need to report both which of the annotated events are drivers, but also which sets of events are always found in the same samples and, therefore, have same patterns of 0s and 1s.</p>
<p>An example dataset is the following</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">mtree_input<span class="op">$</span>binary_clusters</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #555555;"># A tibble: 4 x 14</span><span>
#&gt;   Misc  patientID cluster is.driver is.clonal PD9193d PD9193e PD9193f
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>       </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> cuto… PD9193    2       FALSE     FALSE           1       1       1
#&gt; </span><span style="color: #555555;">2</span><span> cuto… PD9193    3       TRUE      FALSE           1       0       0
#&gt; </span><span style="color: #555555;">3</span><span> cuto… PD9193    1       TRUE      TRUE            1       1       1
#&gt; </span><span style="color: #555555;">4</span><span> cuto… PD9193    4       TRUE      FALSE           1       0       1
#&gt; </span><span style="color: #555555;"># … with 6 more variables: PD9193g </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193h </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193i </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">,
#&gt; #   PD9193j </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193k </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, nMuts </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
</span></code></pre>
<p>Where cluster <code>1</code> represents all the annotated events that are detected across all sequenced biopsies. Notice that this is similar, but not exactly the same, to clusters obtained from <a href="https://caravagn.github.io/ctree">subclonal deconvolution of Cancer Cell Fractions</a>.</p>
<p>The set of drivers annotated in this sequencing data is reported clonality status, <code>variantID</code> and a <code>patientID.</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">mtree_input<span class="op">$</span>drivers</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #555555;"># A tibble: 4 x 15</span><span>
#&gt;   Misc  patientID variantID cluster is.driver is.clonal PD9193d PD9193e
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>       </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> cuto… PD9193    SMARCA4   3       TRUE      FALSE           1       0
#&gt; </span><span style="color: #555555;">2</span><span> cuto… PD9193    GATA3     1       TRUE      TRUE            1       1
#&gt; </span><span style="color: #555555;">3</span><span> cuto… PD9193    +8q       4       TRUE      FALSE           1       0
#&gt; </span><span style="color: #555555;">4</span><span> cuto… PD9193    -8p       4       TRUE      FALSE           1       0
#&gt; </span><span style="color: #555555;"># … with 7 more variables: PD9193f </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193g </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193h </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">,
#&gt; #   PD9193i </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193j </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193k </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, nMuts </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
</span></code></pre>
<p><strong>Other data</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">mtree_input<span class="op">$</span>samples</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; [1] "PD9193d" "PD9193e" "PD9193f" "PD9193g" "PD9193h" "PD9193i" "PD9193j"</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; [8] "PD9193k"</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">mtree_input<span class="op">$</span>patient</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; [1] "PD9193"</span></a></code></pre></div>
</div>
<div id="creation-of-a-mutation-tree" class="section level3">
<h3 class="hasAnchor">
<a href="#creation-of-a-mutation-tree" class="anchor"></a>Creation of a mutation tree</h3>
<p>You can use a sampler and control its parameters – see <code>mtrees</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">x =<span class="st"> </span><span class="kw"><a href="../reference/mtrees.html">mtrees</a></span>(</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  mtree_input<span class="op">$</span>binary_clusters, </a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  mtree_input<span class="op">$</span>drivers,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  mtree_input<span class="op">$</span>samples,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  mtree_input<span class="op">$</span>patient,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  mtree_input<span class="op">$</span>sspace.cutoff,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">  mtree_input<span class="op">$</span>n.sampling,</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  mtree_input<span class="op">$</span>store.max</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">)</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #BBBBBB;background-color: #0000BB;"> [ mtree ~ generate mutation trees for PD9193 ] 
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">Sampler : </span><span> 10000 (cutoff),  5000 (sampling),  100 (max store) </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Suppes' conditions : </span><span> &gt;= </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #555555;"># A tibble: 4 x 14</span><span>
#&gt;   Misc  patientID cluster is.driver is.clonal PD9193d PD9193e PD9193f
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>       </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> cuto… PD9193    2       FALSE     FALSE           1       1       1
#&gt; </span><span style="color: #555555;">2</span><span> cuto… PD9193    3       TRUE      FALSE           1       0       0
#&gt; </span><span style="color: #555555;">3</span><span> cuto… PD9193    1       TRUE      TRUE            1       1       1
#&gt; </span><span style="color: #555555;">4</span><span> cuto… PD9193    4       TRUE      FALSE           1       0       1
#&gt; </span><span style="color: #555555;"># … with 6 more variables: PD9193g </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193h </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193i </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">,
#&gt; #   PD9193j </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193k </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, nMuts </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; 
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Structures</span><span> 3 - search is exahustive </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Trees with non-zero sscore</span><span> 3 storing 3 </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span>
</span></code></pre>
<p>The sampler creates a number of mutation trees that can fit the data according to a model that integrates <a href="https://en.wikipedia.org/wiki/Chow%E2%80%93Liu_tree">Chow-Liu trees</a> with <a href="https://plato.stanford.edu/entries/causation-probabilistic/">probabilistic causation</a>.</p>
<p>In particular, if we denote with <span class="math inline">\(p(\cdot)\)</span> the empirical probability of a variable from the data, then the presence of an edge <span class="math inline">\(x \to y\)</span> requires these conditions to be satisfied.</p>
<ul>
<li>
<span class="math inline">\(p(x) \geq p(y)\)</span>;</li>
<li>
<span class="math inline">\(p(x,y) \geq p(x)p(y)\)</span> which implies <span class="math inline">\(p(y|x) \geq p(y|\neg x)\)</span>;</li>
</ul>
<p>These are relaxations of Suppes’ original strict conditions (i.e., <span class="math inline">\(p(x) &gt; p(y)\)</span>) for probabilistic causation, and are termed temporal priority and probability raising; <a href="https://www.pnas.org/content/113/28/E4025">PMID 27357673</a>. These conditions are used to create a partially ordered set, from which possible trees are generated. In the Chow-Liu style, the trees are scored according to the mutual information among the connected variables, which is the quantity that one seeks to maximise.</p>
<p>We work with the top-ranking model.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">x =<span class="st"> </span>x[[<span class="dv">1</span>]]</a></code></pre></div>
</div>
<div id="visualisations" class="section level3">
<h3 class="hasAnchor">
<a href="#visualisations" class="anchor"></a>Visualisations</h3>
<p>S3 functions for printing, and summarizing the object.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(x)</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #BBBBBB;background-color: #0000BB;"> [ mtree - mtree rank 1/3 for PD9193 ] 
#&gt; </span><span>
#&gt; </span><span style="color: #555555;"># A tibble: 4 x 14</span><span>
#&gt;   Misc  patientID cluster is.driver is.clonal PD9193d PD9193e PD9193f
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>       </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> cuto… PD9193    2       FALSE     FALSE           1       1       1
#&gt; </span><span style="color: #555555;">2</span><span> cuto… PD9193    3       TRUE      FALSE           1       0       0
#&gt; </span><span style="color: #555555;">3</span><span> cuto… PD9193    1       TRUE      TRUE            1       1       1
#&gt; </span><span style="color: #555555;">4</span><span> cuto… PD9193    4       TRUE      FALSE           1       0       1
#&gt; </span><span style="color: #555555;"># … with 6 more variables: PD9193g </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193h </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193i </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">,
#&gt; #   PD9193j </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, PD9193k </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span style="color: #555555;">, nMuts </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Tree shape (drivers annotated)</span><span>  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; </span><span>  \-GL
#&gt;    \-1 [PD9193k] :: GATA3
#&gt;     |-4 :: +8q, -8p
#&gt;     | \-3 :: SMARCA4
#&gt;     \-2
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Information transfer</span><span>  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; </span><span>   +8q ---&gt; SMARCA4 
#&gt;    -8p ---&gt; SMARCA4 
#&gt;    GL ---&gt; GATA3 
#&gt;    GATA3 ---&gt; +8q 
#&gt;    GATA3 ---&gt; -8p 
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Tree score</span><span> 0.000697748027942915 </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span>
</span></code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(x)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt;             Length Class     Mode     </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; adj_mat     25     -none-    numeric  </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; tb_adj_mat  10     tbl_graph list     </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; score        1     -none-    numeric  </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; patient      1     -none-    character</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; samples      8     -none-    character</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; drivers     15     tbl_df    list     </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; CCF         14     tbl_df    list     </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; binary       1     -none-    logical  </span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; transfer     2     -none-    list     </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; annotation   1     -none-    character</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt; tree_type    1     -none-    character</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt; evaluation   1     -none-    character</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; binary_data 14     tbl_df    list     </span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; Suppes       3     -none-    list</span></a></code></pre></div>
<p>Then some plotting functions for the tree. A tree layout is used to display the mutation tree and the information transfer, which corresponds to the ordering of the drivers annnotated in the tree. This terminology is borrowed from the <a href="https://github.com/caravagn/revolver">REVOLVER</a> algorithm, where it is used to refer to the set of trajectories that a patient “transfers” to another patient during the fit.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; Warning: Duplicated aesthetics after name standardisation: na.rm</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_point).</span></a></code></pre></div>
<p><img src="mtree_files/figure-html/unnamed-chunk-10-1.png" width="480"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/plot_information_transfer.html">plot_information_transfer</a></span>(x)</a></code></pre></div>
<p><img src="mtree_files/figure-html/unnamed-chunk-10-2.png" width="480"></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/plot_icon.html">plot_icon</a></span>(x)</a></code></pre></div>
<p><img src="mtree_files/figure-html/unnamed-chunk-11-1.png" width="192"></p>
<p>For the data, you can plot the binary clusters.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="../reference/plot_binary_clusters.html">plot_binary_clusters</a></span>(x)</a></code></pre></div>
<p><img src="mtree_files/figure-html/unnamed-chunk-12-1.png" width="480"></p>
<p>Also, you can plot the reslt of evaluating Suppes’ conditions on the data of this tree.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/plot_Suppes.html">plot_Suppes</a></span>(x)</a></code></pre></div>
<p><img src="mtree_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<p>Or you can plot the size of each binary cluster as a barplot. This barplot is annotated to report wether a cluster of alterations with a driver is significantly larger than the expected size for the cases without driver. To carry out this test subclones without drivers are used to estimate the parameters of a univariate Gaussian distribution (mean and standard deviation), the p-value is then computed from the fit distribution through the <code>pnorm</code> function. The alpha level for the test can be passed as parameter.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/plot_clone_size.html">plot_clone_size</a></span>(x)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_text).</span></a></code></pre></div>
<p><img src="mtree_files/figure-html/unnamed-chunk-14-1.png" width="480"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Giulio Caravagna.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
