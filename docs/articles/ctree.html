<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ctree • ctree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ctree">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ctree.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>ctree</h1>
            
      
      
      <div class="hidden name"><code>ctree.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># To render in colour this vignette</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">old.hooks &lt;-<span class="st"> </span>fansi<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/fansi/topics/set_knit_hooks">set_knit_hooks</a></span>(knitr<span class="op">::</span>knit_hooks)</a></code></pre></div>
<style type="text/css" scoped>
PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};
</style>
<p>The <code>ctree</code> is a package to implement basic functions to create, manipulate and visualize clone trees. A clone tree is a tree built from the results of a subclonal deconvolution analysis of bulk DNA sequencing data. The trees created with <code>ctree</code> are used inside <a href="https://github.com/caravagn/revolver">REVOLVER</a>, a package that implements one algorithm to determine <a href="https://www.nature.com/articles/s41592-018-0108-x">repeated cancer evolution from multi-region sequencing data of human cancers</a>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ctree)</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #BBBBBB;background-color: #0000BB;"> [ ctree - Clone Trees in cancer ] 
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">Author : </span><span> Giulio Caravagna &lt;gcaravagn@gmail.com&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; GitHub : </span><span> caravagn/ctree </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span>
</span></code></pre>
<p>To build a clone tree you need some basic datal; an example dataset is attached to the package and can be used to create a <code>ctree</code> S3 object.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">'ctree_input'</span>)</a></code></pre></div>
<div id="required-data" class="section level3">
<h3 class="hasAnchor">
<a href="#required-data" class="anchor"></a>Required data</h3>
<p><strong>Cancer Cell Fractions</strong></p>
<p>Cancer Cell Fractions (CCF) clusters obtained from subclonal deconvolution analysis of bulk DNA sequencing data are required,</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">ctree_input<span class="op">$</span>CCF_clusters</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #555555;"># A tibble: 7 x 7</span><span>
#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;int&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> 1          72 TRUE      FALSE      0     0.92  0   
#&gt; </span><span style="color: #555555;">2</span><span> 2          69 TRUE      TRUE       0.99  0.98  0.99
#&gt; </span><span style="color: #555555;">3</span><span> 3          48 FALSE     FALSE      0     0     0.49
#&gt; </span><span style="color: #555555;">4</span><span> 4          29 FALSE     FALSE      0.01  0.01  0.93
#&gt; </span><span style="color: #555555;">5</span><span> 5          24 TRUE      FALSE      0.78  0     0   
#&gt; </span><span style="color: #555555;">6</span><span> 6          23 TRUE      FALSE      0.98  0.03  0.98
#&gt; </span><span style="color: #555555;">7</span><span> 7          15 FALSE     FALSE      0     0.41  0
</span></code></pre>
<p>If you need tools to compute CCF values, the <a href="https://caravagn.github.io/evoverse/">evoverse</a> collection of packages for Cancer Evolution analysis contains both <a href="https://caravagn.github.io/mobster/">MOBSTER</a> and <a href="https://caravagn.github.io/viber/">VIBER</a>. Otherwise, a number of other packages can be used (pyClone, sciClone, DPClust, etc.).</p>
<p>Driver events mapped to the CCF clusters, with reported clonality status, a <code>variantID</code> and a <code>patientID.</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">ctree_input<span class="op">$</span>drivers</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #555555;"># A tibble: 7 x 8</span><span>
#&gt;   patientID variantID is.driver is.clonal cluster    R1    R2    R3
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> CRUK0002  RB1       TRUE      FALSE     1        0     0.92  0   
#&gt; </span><span style="color: #555555;">2</span><span> CRUK0002  IKZF1     TRUE      FALSE     1        0     0.92  0   
#&gt; </span><span style="color: #555555;">3</span><span> CRUK0002  KRAS      TRUE      FALSE     1        0     0.93  0   
#&gt; </span><span style="color: #555555;">4</span><span> CRUK0002  MET       TRUE      TRUE      2        0.99  0.98  0.99
#&gt; </span><span style="color: #555555;">5</span><span> CRUK0002  TERT      TRUE      TRUE      2        0.99  0.98  0.99
#&gt; </span><span style="color: #555555;">6</span><span> CRUK0002  NF1       TRUE      FALSE     5        0.78  0     0   
#&gt; </span><span style="color: #555555;">7</span><span> CRUK0002  EP300     TRUE      FALSE     6        0.96  0.03  0.98
</span></code></pre>
<p><strong>Other data</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">ctree_input<span class="op">$</span>samples</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; [1] "R1" "R2" "R3"</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">ctree_input<span class="op">$</span>patient</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; [1] "CUK12345"</span></a></code></pre></div>
</div>
<div id="creation-of-a-clone-tree" class="section level3">
<h3 class="hasAnchor">
<a href="#creation-of-a-clone-tree" class="anchor"></a>Creation of a clone tree</h3>
<p>You can use a sampler and control its parameters – see <code>~ctrees</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">x =<span class="st"> </span><span class="kw"><a href="../reference/ctrees.html">ctrees</a></span>(</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  ctree_input<span class="op">$</span>CCF_clusters, </a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  ctree_input<span class="op">$</span>drivers,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  ctree_input<span class="op">$</span>samples,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  ctree_input<span class="op">$</span>patient,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  ctree_input<span class="op">$</span>sspace.cutoff,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">  ctree_input<span class="op">$</span>n.sampling,</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  ctree_input<span class="op">$</span>store.max</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">)</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #BBBBBB;background-color: #0000BB;"> [ ctree ~ generate clone trees for CUK12345 ] 
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">Sampler : </span><span> 10000 (cutoff),  5000 (sampling),  100 (max store) </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #555555;"># A tibble: 7 x 7</span><span>
#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;int&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> 1          72 TRUE      FALSE      0     0.92  0   
#&gt; </span><span style="color: #555555;">2</span><span> 2          69 TRUE      TRUE       0.99  0.98  0.99
#&gt; </span><span style="color: #555555;">3</span><span> 3          48 FALSE     FALSE      0     0     0.49
#&gt; </span><span style="color: #555555;">4</span><span> 4          29 FALSE     FALSE      0.01  0.01  0.93
#&gt; </span><span style="color: #555555;">5</span><span> 5          24 TRUE      FALSE      0.78  0     0   
#&gt; </span><span style="color: #555555;">6</span><span> 6          23 TRUE      FALSE      0.98  0.03  0.98
#&gt; </span><span style="color: #555555;">7</span><span> 7          15 FALSE     FALSE      0     0.41  0   
#&gt; 
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Region</span><span> R1  ~  #CCF clusters &gt; 1%:  3 </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Region</span><span> R2  ~  #CCF clusters &gt; 1%:  4 </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Region</span><span> R3  ~  #CCF clusters &gt; 1%:  4 </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Trees per region</span><span> 1, 3, 1 </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Hashed trees</span><span> 5 </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Structures</span><span> 3 - search is exahustive </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Pigeonhole Principle</span><span>  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Ranking trees</span><span>  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span style="color: #00BB00;background-color: #BBBB00;">✔</span><span style="color: #000000;background-color: #BBBB00;"> Trees with non-zero sscore</span><span> 3 storing 3 </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span>
</span></code></pre>
<p>The sampler creates a number of clone trees that can fit the data according to an error model that allows violations of the pigeonhole principle. We work with the top-ranking model.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">x =<span class="st"> </span>x[[<span class="dv">1</span>]]</a></code></pre></div>
</div>
<div id="visualisations" class="section level3">
<h3 class="hasAnchor">
<a href="#visualisations" class="anchor"></a>Visualisations</h3>
<p>S3 functions for printing, and summarizing the object.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(x)</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #BBBBBB;background-color: #0000BB;"> [ ctree - ctree rank 1/3 for CUK12345 ] 
#&gt; </span><span>
#&gt; </span><span style="color: #555555;"># A tibble: 7 x 7</span><span>
#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;int&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> 1          72 TRUE      FALSE      0     0.92  0   
#&gt; </span><span style="color: #555555;">2</span><span> 2          69 TRUE      TRUE       0.99  0.98  0.99
#&gt; </span><span style="color: #555555;">3</span><span> 3          48 FALSE     FALSE      0     0     0.49
#&gt; </span><span style="color: #555555;">4</span><span> 4          29 FALSE     FALSE      0.01  0.01  0.93
#&gt; </span><span style="color: #555555;">5</span><span> 5          24 TRUE      FALSE      0.78  0     0   
#&gt; </span><span style="color: #555555;">6</span><span> 6          23 TRUE      FALSE      0.98  0.03  0.98
#&gt; </span><span style="color: #555555;">7</span><span> 7          15 FALSE     FALSE      0     0.41  0   
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Tree shape (drivers annotated)</span><span>  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; </span><span>  \-GL
#&gt;    \-2 :: MET, TERT
#&gt;     |-1 :: RB1, IKZF1, KRAS
#&gt;     | \-7
#&gt;     \-6 :: EP300
#&gt;      |-4
#&gt;      | \-3
#&gt;      \-5 :: NF1
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Information transfer</span><span>  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; </span><span>   MET ---&gt; RB1 
#&gt;    MET ---&gt; IKZF1 
#&gt;    MET ---&gt; KRAS 
#&gt;    TERT ---&gt; RB1 
#&gt;    TERT ---&gt; IKZF1 
#&gt;    TERT ---&gt; KRAS 
#&gt;    GL ---&gt; MET 
#&gt;    GL ---&gt; TERT 
#&gt;    EP300 ---&gt; NF1 
#&gt;    MET ---&gt; EP300 
#&gt;    TERT ---&gt; EP300 
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Tree score</span><span> 0.6 </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; </span><span>
</span></code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(x)</a></code></pre></div>
<pre class="fansi fansi-output"><code>#&gt; <span style="color: #BBBBBB;background-color: #0000BB;"> [ ctree - ctree rank 1/3 for CUK12345 ] 
#&gt; </span><span>
#&gt; </span><span style="color: #555555;"># A tibble: 7 x 7</span><span>
#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;int&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> 1          72 TRUE      FALSE      0     0.92  0   
#&gt; </span><span style="color: #555555;">2</span><span> 2          69 TRUE      TRUE       0.99  0.98  0.99
#&gt; </span><span style="color: #555555;">3</span><span> 3          48 FALSE     FALSE      0     0     0.49
#&gt; </span><span style="color: #555555;">4</span><span> 4          29 FALSE     FALSE      0.01  0.01  0.93
#&gt; </span><span style="color: #555555;">5</span><span> 5          24 TRUE      FALSE      0.78  0     0   
#&gt; </span><span style="color: #555555;">6</span><span> 6          23 TRUE      FALSE      0.98  0.03  0.98
#&gt; </span><span style="color: #555555;">7</span><span> 7          15 FALSE     FALSE      0     0.41  0   
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Tree shape (drivers annotated)</span><span>  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; </span><span>  \-GL
#&gt;    \-2 :: MET, TERT
#&gt;     |-1 :: RB1, IKZF1, KRAS
#&gt;     | \-7
#&gt;     \-6 :: EP300
#&gt;      |-4
#&gt;      | \-3
#&gt;      \-5 :: NF1
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Information transfer</span><span>  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; </span><span>   MET ---&gt; RB1 
#&gt;    MET ---&gt; IKZF1 
#&gt;    MET ---&gt; KRAS 
#&gt;    TERT ---&gt; RB1 
#&gt;    TERT ---&gt; IKZF1 
#&gt;    TERT ---&gt; KRAS 
#&gt;    GL ---&gt; MET 
#&gt;    GL ---&gt; TERT 
#&gt;    EP300 ---&gt; NF1 
#&gt;    MET ---&gt; EP300 
#&gt;    TERT ---&gt; EP300 
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Tree score</span><span> 0.6 </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; CCF clusters:</span><span>  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; </span><span style="color: #555555;"># A tibble: 7 x 7</span><span>
#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;int&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> 1          72 TRUE      FALSE      0     0.92  0   
#&gt; </span><span style="color: #555555;">2</span><span> 2          69 TRUE      TRUE       0.99  0.98  0.99
#&gt; </span><span style="color: #555555;">3</span><span> 3          48 FALSE     FALSE      0     0     0.49
#&gt; </span><span style="color: #555555;">4</span><span> 4          29 FALSE     FALSE      0.01  0.01  0.93
#&gt; </span><span style="color: #555555;">5</span><span> 5          24 TRUE      FALSE      0.78  0     0   
#&gt; </span><span style="color: #555555;">6</span><span> 6          23 TRUE      FALSE      0.98  0.03  0.98
#&gt; </span><span style="color: #555555;">7</span><span> 7          15 FALSE     FALSE      0     0.41  0   
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Drivers:</span><span>  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; </span><span style="color: #555555;"># A tibble: 7 x 8</span><span>
#&gt;   patientID variantID is.driver is.clonal cluster    R1    R2    R3
#&gt;   </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;lgl&gt;</span><span>     </span><span style="color: #555555;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #555555;font-style: italic;">&lt;dbl&gt;</span><span>
#&gt; </span><span style="color: #555555;">1</span><span> CRUK0002  RB1       TRUE      FALSE     1        0     0.92  0   
#&gt; </span><span style="color: #555555;">2</span><span> CRUK0002  IKZF1     TRUE      FALSE     1        0     0.92  0   
#&gt; </span><span style="color: #555555;">3</span><span> CRUK0002  KRAS      TRUE      FALSE     1        0     0.93  0   
#&gt; </span><span style="color: #555555;">4</span><span> CRUK0002  MET       TRUE      TRUE      2        0.99  0.98  0.99
#&gt; </span><span style="color: #555555;">5</span><span> CRUK0002  TERT      TRUE      TRUE      2        0.99  0.98  0.99
#&gt; </span><span style="color: #555555;">6</span><span> CRUK0002  NF1       TRUE      FALSE     5        0.78  0     0   
#&gt; </span><span style="color: #555555;">7</span><span> CRUK0002  EP300     TRUE      FALSE     6        0.96  0.03  0.98
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Pigeonhole principle:</span><span> </span><span style="color: #00BB00;">12</span><span> </span><span style="color: #BB0000;">0</span><span> </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; </span><span>    R1   R2   R3
#&gt; 1 TRUE TRUE TRUE
#&gt; 2 TRUE TRUE TRUE
#&gt; 4 TRUE TRUE TRUE
#&gt; 6 TRUE TRUE TRUE
#&gt; </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; Goodness-of-fit:</span><span> 1  </span><span style="color: #000000;background-color: #BBBB00;">
#&gt; 
#&gt; </span><span>
</span></code></pre>
<p>Then some plotting functions for the tree. A tree layout is used to display the clone tree and the information transfer, which corresponds to the ordering of the drivers annnotated in the tree. This terminology is borrowed from the <a href="https://github.com/caravagn/revolver">REVOLVER</a> algorithm, where it is used to refer to the set of trajectories that a patient “transfers” to another patient during the fit.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(x)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; Warning: Duplicated aesthetics after name standardisation: na.rm</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_point).</span></a></code></pre></div>
<p><img src="ctree_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/plot_information_transfer.html">plot_information_transfer</a></span>(x)</a></code></pre></div>
<p><img src="ctree_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/plot_icon.html">plot_icon</a></span>(x)</a></code></pre></div>
<p><img src="ctree_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>For the data, you can plot the CCF of the clusters.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="../reference/plot_CCF_clusters.html">plot_CCF_clusters</a></span>(x)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; Warning: Removed 8 rows containing missing values (geom_text).</span></a></code></pre></div>
<p><img src="ctree_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>Or you can plot the size of each CCF cluster as a barplot. This barplot is annotated to report wether a subclone with a driver is significantly larger than the expected size for a subclone without driver. To carry out this test subclones without drivers are used to estimate the parameters of a univariate Gaussian distribution (mean and standard deviation), the p-value is then computed from the fit distribution through the <code>pnorm</code> function. The confidence level for the test can be passed as parameter.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/plot_clone_size.html">plot_clone_size</a></span>(x)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#&gt; Warning: Removed 3 rows containing missing values (geom_text).</span></a></code></pre></div>
<p><img src="ctree_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Giulio Caravagna.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
